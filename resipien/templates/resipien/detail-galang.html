{% extends 'base_nav_user.html' %}

{% load static %}

{% block meta %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<link rel="stylesheet" href="{% static 'css/resipien.css' %}">

<title>Buat Galang Dana</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<style>

  #btn-komen {
    background-color: #d28542;
  }

</style>

<script>

function submitKomentar(id) {
  $.ajax({
      type: "POST",
      url: "{% url 'resipien:add-komentar' id %}",
      data: {
        csrfmiddlewaretoken: "{{ csrf_token }}", 
        komen: $("#komen").val(),
      },
        dataType: "json",
        success: function () {
        refresh();
        document.getElementById("komentar").value = "";
      },
  });
}

</script>

{% endblock meta %}


{% block content %}

{% load crispy_forms_tags %}

<div id="container-detail">
  <div id="container-data">
    <div id="container-gambar">
      {% if galang.gambar %}
        <img id="img-detail" src="{{ galang.gambar.url}}" style="max-height:300px">
      {% else %}
        <img id="img-detail" src="{% static 'images/noimage.jpeg' %}" style="max-height:300px">
      {% endif %}
    </div>
    <h1 id="judul-galang">{{galang.judul}}</h1>
    <p>{{galang.deskripsi}}</p>
    <p>{{galang.target}}</p>
    <p>{{galang.judul}}</p>
    <form id="formK" method="POST" >
      {% csrf_token %}
      <textarea id="komen" rows="7" cols="80" placeholder="Tulis komentar..."></textarea>
      <a role="button"id="btn-komen" class="btn" onclick="submitKomentar('{{galang.id}}')" >Tambah Komentar</a>
    </form>
    
    <div id="komentar"></div>
    {% for komentar in komen %}
      <h4>{{komentar.user.username}}</h4>
      <p>{{komentar.komentar}}</p>
    {% endfor %}

  </div>
</div>
  
{% endblock content %}
